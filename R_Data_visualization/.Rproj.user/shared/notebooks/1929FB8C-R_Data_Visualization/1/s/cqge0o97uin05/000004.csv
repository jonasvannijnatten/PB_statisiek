"0","# apply linear regression and obtain regression coefficients"
"0","lin_mod = summary(lm(data = data.long, formula = salary~experience))"
"0","alpha = round(lin_mod$coefficients[1],2)"
"0","beta  = round(lin_mod$coefficients[2],2)"
"0","corr_coef = round(sqrt(lin_mod$r.squared),3)"
"0",""
"0","# create figure  "
"0","ggplot(data = data.long, aes(x = experience, y = salary)) +"
"0","  geom_point() +  # plot the datapoints"
"0","  # add a linear regression line with 95% confidence interval"
"0","  geom_smooth(method='lm', formula = 'y ~ x', se=TRUE, level=0.95) +"
"0","  # plot the correlation coefficient into to figure"
"0","  geom_text(x = 12, y = 10275, color=""blue"","
"0","            label = paste(""salary = "", alpha, ""+"", beta,""*"",""experience, r ="",corr_coef))"
